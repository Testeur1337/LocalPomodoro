:root {
  --bg: #f6f7fb;
  --surface: #ffffff;
  --text: #1f2330;
  --muted: #6f7688;
  --primary: #4a67ff;
  --danger: #d94a58;
  --border: #dfe3ee;
}
:root[data-theme='dark'] {
  --bg: #151821;
  --surface: #202634;
  --text: #e9ecf5;
  --muted: #a1a8bc;
  --primary: #8ca2ff;
  --danger: #ff7c8c;
  --border: #3a4258;
}
* { box-sizing: border-box; }
body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: var(--bg); color: var(--text); }
.app { max-width: 920px; margin: 0 auto; min-height: 100vh; display: flex; flex-direction: column; padding: 1rem; gap: 1rem; }
.app-header, .row, .space-between { display: flex; align-items: center; }
.app-header, .space-between { justify-content: space-between; }
.wrap { flex-wrap: wrap; gap: .5rem; }
.panel { background: var(--surface); border: 1px solid var(--border); border-radius: 1rem; padding: 1rem; }
.mode-label { text-align: center; font-size: 1.2rem; color: var(--muted); }
.timer-display { text-align: center; font-size: clamp(3rem, 10vw, 5rem); margin: .2rem 0 .8rem; font-weight: 700; }
.progress-track { width: 100%; height: .8rem; border-radius: 999px; background: var(--border); overflow: hidden; }
.progress-fill { height: 100%; width: 0; background: var(--primary); transition: width .2s linear; }
.controls { display: flex; flex-wrap: wrap; gap: .5rem; margin-top: 1rem; }
.btn, .icon-btn, select, input[type='text'], input[type='number'], input[type='date'], input[type='time'], textarea {
  border: 1px solid var(--border); background: var(--surface); color: var(--text); border-radius: .6rem; padding: .55rem .8rem;
}
textarea { width: 100%; }
.btn { cursor: pointer; }
.btn.primary { background: var(--primary); color: #fff; border-color: transparent; }
.btn.danger { background: var(--danger); color: #fff; border-color: transparent; }
.btn:disabled { opacity: .5; cursor: not-allowed; }
.icon-btn { cursor: pointer; }
.switch-row { display: flex; gap: .55rem; align-items: center; margin-top: .75rem; }
.inline-info { margin-top: 1rem; display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:.5rem; }
.tabbar { display: grid; grid-template-columns: repeat(5, 1fr); gap: .4rem; position: sticky; bottom: 0; background: var(--bg); padding-bottom: .5rem; }
.tab { border: 1px solid var(--border); background: var(--surface); color: var(--text); border-radius: .7rem; padding: .6rem .4rem; }
.tab.active { border-color: var(--primary); color: var(--primary); font-weight: 600; }
.task-list { list-style: none; padding: 0; margin: 1rem 0 0; display: flex; flex-direction: column; gap: .5rem; }
.task-item { border: 1px solid var(--border); border-radius: .7rem; padding: .55rem; display: grid; grid-template-columns: 1fr auto; gap: .4rem; }
.task-main { display: flex; gap: .45rem; align-items: center; flex-wrap: wrap; }
.task-actions { display: flex; gap: .35rem; flex-wrap: wrap; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: .6rem; }
.card { border: 1px solid var(--border); border-radius: .8rem; padding: .6rem; }
.card h3 { font-size: .82rem; color: var(--muted); margin: 0; }
.card p { font-size: 1.5rem; margin: .3rem 0 0; }
.heatmap-grid { display: grid; grid-auto-flow: column; grid-template-rows: repeat(7, 12px); grid-auto-columns: 12px; gap: 3px; overflow-x: auto; padding: .4rem 0; }
.heatmap-cell { border: 1px solid var(--border); border-radius: 2px; cursor: pointer; }
.heat-0 { background: transparent; }
.heat-1 { background: #d2ddff; }
.heat-2 { background: #9fb4ff; }
.heat-3 { background: #6b8dff; }
.heat-4 { background: #355eff; }
:root[data-theme='dark'] .heat-1 { background: #25324f; }
:root[data-theme='dark'] .heat-2 { background: #334e8e; }
:root[data-theme='dark'] .heat-3 { background: #4f73c9; }
:root[data-theme='dark'] .heat-4 { background: #7fa0ff; }
.settings-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: .7rem; }
.settings-grid label { display: flex; flex-direction: column; gap: .35rem; }
.planner-layout { display: grid; grid-template-columns: 60px 1fr; gap: .6rem; margin-top: .6rem; }
.planner-hours { display: flex; flex-direction: column; }
.hour-mark { height: 48px; font-size: .72rem; color: var(--muted); border-top: 1px dashed var(--border); }
.planner-timeline { position: relative; min-height: 300px; border: 1px solid var(--border); border-radius: .7rem; background: linear-gradient(to bottom, transparent 47px, var(--border) 48px) repeat-y; background-size: 100% 48px; }
.time-block { position: absolute; left: 8px; right: 8px; background: rgba(74,103,255,.12); border: 1px solid var(--primary); border-radius: .4rem; padding: .3rem .4rem; font-size: .85rem; display: flex; justify-content: space-between; gap: .4rem; }
.block-actions { display: flex; gap: .25rem; flex-wrap: wrap; }
.workspace-box { border: 1px solid var(--border); border-radius: .8rem; padding: .75rem; margin-top: .5rem; }
.workspace-box p { margin: .25rem 0; }
.muted { color: var(--muted); font-size: .9rem; }
.workspace-dirty { color: var(--danger); font-weight: 600; }
.workspace-saved { color: var(--muted); }
.status { margin: 0; min-height: 1.3rem; color: var(--muted); }
.reflection-form label { display:flex; flex-direction:column; gap:.25rem; margin-top:.5rem; }

.session-done-banner { display:flex; align-items:center; justify-content:space-between; gap:.6rem; border:1px solid var(--primary); background:rgba(74,103,255,.12); border-radius:.7rem; padding:.6rem .75rem; }
